# ğŸ“… 25ë…„ 6ì›” 26ì¼

## âœ… í•´ê²°í•œ ë¬¸ì œë“¤
DBì„œë²„ ì¬ë¶€íŒ… í›„ DB ì—°ê²° ë¬¸ì œ í•´ê²°
## âŒ ë¬¸ì œ ìƒí™©
### 1ï¸âƒ£ OPEN WEB UIì—ì„œ ã…‡ã…‡ã…‡ ì…ë ¥
```bash
ã…‡ã…‡ã…‡

                Client Question :
                    ã…‡ã…‡ã…‡
                Before Result : 


                Guidelines :
                    - Look at "Client Question :" and "Before Result" and if the question is sufficiently answered, reply FINISH|FINISH|FINISH.
                    - You are an intelligent AI bot specialized in providing information about Jeonbuk University (JBNU). Users will ask questions related to JBNU, and you, as "Bot", should answer them.
                    - Please use the list of tools below to answer user questions so that responses can be generated based on your tools (you must follow up according to the response guidlines).
                    - You can use multiple tools (more than 0) and configure the tools freely, and I will ask you questions about the results of using each tool.
                    - If there is JSON in the response, avoid escaping it.
                    - If "Before Result:" is an empty value, you must use more than one tool.

                Tool list :
                    [{'tool_name': 'FINISH', 'tool_description': 'ì‚¬ìš©ìì˜ ì§ˆë¬¸ì— ëŒ€í•´ì„œ 0ë²ˆ ì´ìƒì˜ íˆ´ì„ ì„ íƒí•˜ì—¬ ì²˜ë¦¬í•œ ê²°ê³¼ë¥¼ í†µí•´ ì‘ë‹µì„ í•´ë„ ê´œì°®ì„ ê²½ìš° ì„ íƒí•˜ëŠ” íˆ´', 'api_body': 'FINISH'}, {'tool_name': 'TOOLSQL', 'tool_description': 'ì „ë¶ëŒ€í•™êµì˜ : ë‹¨ê³¼ëŒ€í•™ / ëª¨ë“  í•™ê³¼ ë° í•™ë¶€ / ëª¨ë“  ê°œì„¤ ê°•ì¢Œ / êµìˆ˜ /  ìˆ˜ì—…ì— ëŒ€í•œ ë°ì´í„° í…Œì´ë¸”ì„ ê¸°ë°˜ìœ¼ë¡œ ì§ˆë¬¸ì— ëŒ€í•œ ì‘ë‹µì„ ë°›ì„ ìˆ˜ ìˆëŠ” íˆ´ì…ë‹ˆë‹¤', 'api_body': '{"query":"ì‚¬ìš©ìê°€ ë³´ë‚¸ ì§ˆë¬¸ ìì—°ì–´ ê·¸ëŒ€ë¡œ ë„£ê¸° ì ˆëŒ€ë¡œ SQL ì¿¼ë¦¬ë¥¼ ë„£ìœ¼ë©´ ì•ˆë¨"}'}, {'tool_name': 'ETC', 'tool_description': 'ì „ ë¶ëŒ€í•™êµ ë° ëŒ€í•™êµì— ê´€ë ¨ëœ ì „ë°˜ì ì¸ ì§ˆë¬¸ì´ ì•„ë‹Œ ì™„ì „íˆ ë‹¤ë¥¸ ì§ˆë¬¸ì— ëŒ€í•´ ì‘ë‹µì„ ë§Œë“¤ì–´ ì£¼ëŠ” íˆ´', 'api_body': '{"query":ì‚¬ìš©ìê°€ ë³´ë‚¸ ì§ˆë¬¸ì„ ê·¸ëŒ€ë¡œ ì—¬ê¸°ì— ë‹´ì•„ì£¼ì„¸ìš”"}'}, {'tool_name': 'search', 'tool_description': 'ì…ë ¥í•œ ê³¼ëª©ëª…ê³¼ ìœ ì‚¬í•œ ìˆ˜ì—…ì„ ë²¡í„° ê¸°ë°˜ìœ¼ë¡œ ì¶”ì²œí•© ë‹ˆë‹¤.', 'api_body': '{ "count": 5, "key": "CADë°ì‹¤ìŠµ" }'}]

                You Must respond as following formatt Divide based on | :
                    tool_name|api_body|Reasons for choosing this tool and summary of the process

                Ensure your response follows this format exactly. dot not use other formatt like JSON

TOOLSQL|{"query":"ã…‡ã…‡ã…‡"}|The question is not specific enough, so I will use TOOLSQL to fetch relevant information about Jeonbuk University to possibly provide a better answer.
['TOOLSQL', '{"query":"ã…‡ã…‡ã…‡"}', 'The question is not specific enough, so I will use TOOLSQL to fetch relevant information about Jeonbuk University to possibly provide a better answer.']
TOOLSQL
INFO:     127.0.0.1:47448 - "POST /agent HTTP/1.1" 500 Internal Server Error
ERROR:    Exception in ASGI application
Traceback (most recent call last):
  File "/home/kingc/miniconda3/envs/open-webui/lib/python3.11/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kingc/miniconda3/envs/open-webui/lib/python3.11/site-packages/urllib3/util/connection.py", line 85, in create_connection
    raise err
  File "/home/kingc/miniconda3/envs/open-webui/lib/python3.11/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/kingc/miniconda3/envs/open-webui/lib/python3.11/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
               ^^^^^^^^^^^^^^^^^^^
  File "/home/kingc/miniconda3/envs/open-webui/lib/python3.11/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/home/kingc/miniconda3/envs/open-webui/lib/python3.11/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/home/kingc/miniconda3/envs/open-webui/lib/python3.11/http/client.py", line 1298, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/home/kingc/miniconda3/envs/open-webui/lib/python3.11/http/client.py", line 1058, in _send_output
    self.send(msg)
  File "/home/kingc/miniconda3/envs/open-webui/lib/python3.11/http/client.py", line 996, in send
    self.connect()
  File "/home/kingc/miniconda3/envs/open-webui/lib/python3.11/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
                ^^^^^^^^^^^^^^^^
  File "/home/kingc/miniconda3/envs/open-webui/lib/python3.11/site-packages/urllib3/connection.py", line 213, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7f04c3c325d0>: Failed to establish a new connection: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/kingc/miniconda3/envs/open-webui/lib/python3.11/site-packages/requests/adapters.py", line 589, in send
    resp = conn.urlopen(
           ^^^^^^^^^^^^^
  File "/home/kingc/miniconda3/envs/open-webui/lib/python3.11/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
              ^^^^^^^^^^^^^^^^^^
  File "/home/kingc/miniconda3/envs/open-webui/lib/python3.11/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='210.117.181.113', port=7999): Max retries exceeded with url: /agent (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f04c3c325d0>: Failed to establish a new connection: [Errno 111] Connection refused'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/kingc/miniconda3/envs/open-webui/lib/python3.11/site-packages/uvicorn/protocols/http/httptools_impl.py", line 435, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kingc/miniconda3/envs/open-webui/lib/python3.11/site-packages/uvicorn/middleware/proxy_headers.py", line 78, in __call__
    return await self.app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kingc/miniconda3/envs/open-webui/lib/python3.11/site-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/home/kingc/miniconda3/envs/open-webui/lib/python3.11/site-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/home/kingc/miniconda3/envs/open-webui/lib/python3.11/site-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/home/kingc/miniconda3/envs/open-webui/lib/python3.11/site-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/home/kingc/miniconda3/envs/open-webui/lib/python3.11/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/home/kingc/miniconda3/envs/open-webui/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/home/kingc/miniconda3/envs/open-webui/lib/python3.11/site-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/home/kingc/miniconda3/envs/open-webui/lib/python3.11/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/home/kingc/miniconda3/envs/open-webui/lib/python3.11/site-packages/starlette/routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/home/kingc/miniconda3/envs/open-webui/lib/python3.11/site-packages/starlette/routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "/home/kingc/miniconda3/envs/open-webui/lib/python3.11/site-packages/starlette/routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "/home/kingc/miniconda3/envs/open-webui/lib/python3.11/site-packages/starlette/routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/home/kingc/miniconda3/envs/open-webui/lib/python3.11/site-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/home/kingc/miniconda3/envs/open-webui/lib/python3.11/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/home/kingc/miniconda3/envs/open-webui/lib/python3.11/site-packages/starlette/routing.py", line 72, in app
    response = await func(request)
               ^^^^^^^^^^^^^^^^^^^
  File "/home/kingc/miniconda3/envs/open-webui/lib/python3.11/site-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kingc/miniconda3/envs/open-webui/lib/python3.11/site-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/kingc/Desktop/study/OpenWebUi/owu/ai-mentor/ai_modules/llm_agent-main/controller/agentController.py", line 25, in agent_api
    result = core_service.dynamic_tool_chain(last_user_message)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/kingc/Desktop/study/OpenWebUi/owu/ai-mentor/ai_modules/llm_agent-main/service/coreService.py", line 88, in dynamic_tool_chain
    tool_call_response = requests.post(tool_info['api_url'], json = json.loads(response_api_body))
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kingc/miniconda3/envs/open-webui/lib/python3.11/site-packages/requests/api.py", line 115, in post
    return request("post", url, data=data, json=json, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kingc/miniconda3/envs/open-webui/lib/python3.11/site-packages/requests/api.py", line 59, in request
    return session.request(method=method, url=url, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kingc/miniconda3/envs/open-webui/lib/python3.11/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kingc/miniconda3/envs/open-webui/lib/python3.11/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kingc/miniconda3/envs/open-webui/lib/python3.11/site-packages/requests/adapters.py", line 622, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPConnectionPool(host='210.117.181.113', port=7999): Max retries exceeded with url: /agent (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f04c3c325d0>: Failed to establish a new connection: [Errno 111] Connection refused'))
```

### 2ï¸âƒ£ OPEN WEB UIì—ì„œ ã…‡ã…‡ ì…ë ¥
```bash
ã…‡ã…‡

                Client Question :
                    ã…‡ã…‡
                Before Result :


                Guidelines :
                    - Look at "Client Question :" and "Before Result" and if the question is sufficiently answered, reply FINISH|FINISH|FINISH.
                    - You are an intelligent AI bot specialized in providing information about Jeonbuk University (JBNU). Users will ask questions related to JBNU, and you, as "Bot", should answer them.
                    - Please use the list of tools below to answer user questions so that responses can be generated based on your tools (you must follow up according to the response guidlines).
                    - You can use multiple tools (more than 0) and configure the tools freely, and I will ask you questions about the results of using each tool.
                    - If there is JSON in the response, avoid escaping it.
                    - If "Before Result:" is an empty value, you must use more than one tool.

                Tool list :
                    [{'tool_name': 'FINISH', 'tool_description': 'ì‚¬ìš©ìì˜ ì§ˆë¬¸ì— ëŒ€í•´ì„œ 0ë²ˆ ì´ìƒì˜ íˆ´ì„ ì„ íƒí•˜ì—¬ ì²˜ë¦¬í•œ ê²°ê³¼ë¥¼ í†µí•´ ì‘ë‹µì„ í•´ë„ ê´œì°®ì„ ê²½ìš° ì„ íƒí•˜ëŠ” íˆ´', 'api_body': 'FINISH'}, {'tool_name': 'TOOLSQL', 'tool_description': 'ì „ë¶ëŒ€í•™êµì˜ : ë‹¨ê³¼ëŒ€í•™ / ëª¨ë“  í•™ê³¼ ë° í•™ë¶€ / ëª¨ë“  ê°œì„¤ ê°•ì¢Œ / êµìˆ˜ /  ìˆ˜ì—…ì— ëŒ€í•œ ë°ì´í„° í…Œì´ë¸”ì„ ê¸°ë°˜ìœ¼ë¡œ ì§ˆë¬¸ì— ëŒ€í•œ ì‘ë‹µì„ ë°›ì„ ìˆ˜ ìˆëŠ” íˆ´ì…ë‹ˆë‹¤', 'api_body': '{"query":"ì‚¬ìš©ìê°€ ë³´ë‚¸ ì§ˆë¬¸ ìì—°ì–´ ê·¸ëŒ€ë¡œ ë„£ê¸° ì ˆëŒ€ë¡œ SQL ì¿¼ë¦¬ë¥¼ ë„£ìœ¼ë©´ ì•ˆë¨"}'}, {'tool_name': 'ETC', 'tool_description': 'ì „ ë¶ëŒ€í•™êµ ë° ëŒ€í•™êµì— ê´€ë ¨ëœ ì „ë°˜ì ì¸ ì§ˆë¬¸ì´ ì•„ë‹Œ ì™„ì „íˆ ë‹¤ë¥¸ ì§ˆë¬¸ì— ëŒ€í•´ ì‘ë‹µì„ ë§Œë“¤ì–´ ì£¼ëŠ” íˆ´', 'api_body': '{"query":ì‚¬ìš©ìê°€ ë³´ë‚¸ ì§ˆë¬¸ì„ ê·¸ëŒ€ë¡œ ì—¬ê¸°ì— ë‹´ì•„ì£¼ì„¸ìš”"}'}, {'tool_name': 'search', 'tool_description': 'ì…ë ¥í•œ ê³¼ëª©ëª…ê³¼ ìœ ì‚¬í•œ ìˆ˜ì—…ì„ ë²¡í„° ê¸°ë°˜ìœ¼ë¡œ ì¶”ì²œí•© ë‹ˆë‹¤.', 'api_body': '{ "count": 5, "key": "CADë°ì‹¤ìŠµ" }'}]

                You Must respond as following formatt Divide based on | :
                    tool_name|api_body|Reasons for choosing this tool and summary of the process

                Ensure your response follows this format exactly. dot not use other formatt like JSON

FINISH|FINISH|FINISH
['FINISH', 'FINISH', 'FINISH']
FINISH
{'steps': []}
INFO:     127.0.0.1:33438 - "POST /agent HTTP/1.1" 200 OK
```

## ğŸ“Œ í™•ì¸ ì‚¬í•­
í•„ìš”í•œ `ai_modules`ì´ êº¼ì ¸ìˆëŠ” ë“¯ í•˜ë‹¤.