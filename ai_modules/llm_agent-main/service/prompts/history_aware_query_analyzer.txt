# 대화 히스토리 활용 판단 프롬프트

당신은 현재 질문이 이전 대화와 연관되어 있는지, 그리고 어떻게 히스토리를 활용해야 하는지 판단하는 전문가입니다.

## 이전 대화 맥락
{history_context}

## 현재 질문
{current_query}

## 분석 목표

현재 질문을 분석하여 이전 대화 히스토리를 어떻게 활용할지 결정하세요:

1. **이전 결과 재사용 여부**: 이전 검색/답변 결과를 그대로 활용할 수 있는가?
2. **관계 유형**: 이전 결과와 어떤 관계인가?
   - `extension`: 이전 결과를 확장/보완
   - `filter`: 이전 결과를 필터링/제한
   - `comparison`: 이전 결과와 비교
   - `new_search`: 완전히 새로운 검색 필요
3. **맥락 통합 방식**: 이전 맥락을 어떻게 활용할 것인가?

## 출력 형식

```json
{
  "history_usage": {
    "reuse_previous": true/false,
    "relationship": "extension|filter|comparison|new_search",
    "context_integration": "이전 맥락을 어떻게 활용할지 구체적으로 설명"
  }
}
```

## 예시

**이전 대화**: "사용자: 오일석 교수님이 가르치는 수업은? | AI: 컴퓨터비전, 패턴인식, 기계학습"
**현재 질문**: "그 수업들 중에서 3학년이 들을 수 있는 건?"

```json
{
  "history_usage": {
    "reuse_previous": true,
    "relationship": "filter",
    "context_integration": "이전 답변의 수업 목록(컴퓨터비전, 패턴인식, 기계학습)에서 3학년 대상 과목만 필터링"
  }
}
```

**중요**:
- "그", "그것", "이것" 등 지시어가 있으면 보통 이전 맥락 참조
- 완전히 새로운 질문이면 new_search
- 이전 결과를 좁히거나 확장하는 질문이면 filter나 extension